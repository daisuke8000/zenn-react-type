---
title: "DockerÃ—FastAPIÃ—React(TypeScript) on AWS ECSã€frontendã€‘"
emoji: "ğŸ˜"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [docker, python, react, typescript, aws]
published: false
---

## å‰å›ã®backendç·¨ã‹ã‚‰ã®ç¶šãã§ã™
[backendç·¨](https://zenn.dev/daisukesasaki/articles/f18dd6554f94e3)
æ­£ç›´ã€ãƒ•ãƒ­ãƒ³ãƒˆå´ã¯ã•ã£ã±ã‚Šã‚»ãƒ³ã‚¹ãŒç„¡ã„ï¼‹å¿˜ã‚Œã¾ãã£ã¦ãŸã‚Šã—ãŸã®ã§ã‚ã¡ã‚ƒãã¡ã‚ƒèª¿ã¹ç›´ã—ãŸã€‚
ã‚ã‚‰ãŸã‚ã¦ä¸¡æ–¹ã§ãã‚‹çš†ã•ã‚“ã™ã”ã„ã‚ãã€ã€ï¼ˆã¡ãªã¿ã«åƒ•ã¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã‚‚ã‚»ãƒ³ã‚¹ãªã„ã§ã™ï¼‰
frontendå´ã«å…¥ã‚‹å‰ã«å‰å›ã‚„ã£ãŸå†…å®¹ãŒã¡ã‚‡ã£ã¨åŠç«¯ã ã£ãŸã®ã§ã¾ãšã¯ãã“ã‚’ã‚µã‚¯ãƒƒã¨ä¿®æ­£ã—ã¦ã—ã¾ãŠã†ã¨æ€ã„ã¾ã™ã€‚

### crud.py
```py
# project/backend/app/api/crud.py
from app.models.pydantic import SummaryPayloadSchema
from app.models.tortoise import TextSummary
from typing import Union, List


async def post(payload: SummaryPayloadSchema) -> int:
    summary = TextSummary(
        summary=payload.summary,
    )
    await summary.save()
    return summary.id


async def get_all() -> List:
    summarys = await TextSummary.all().values()
    return summarys


async def get(id: int) -> Union[dict, None]:
    task = await TextSummary.filter(id=id).first().values()
    if task:
        return task[0]
    return None


async def put(id: int, payload: SummaryPayloadSchema) -> Union[dict, None]:
    task = await TextSummary.filter(id=id).update(
        todo=payload.summary
    )
    if task:
        update_task = await TextSummary.filter(id=id).first().values()
        return update_task[0]
    return None


async def delete(id: int) -> int:
    task = await TextSummary.filter(id=id).first().delete()
    return task
```


### main.py
```py
# project/backend/app/main.py
import logging
import os

from fastapi import FastAPI, HTTPException, Path
from typing import List

from app.api import crud
from app.db import init_db
from app.models.tortoise import SummarySchema
from app.models.pydantic import SummaryPayloadSchema, SummaryResponseSchema


log = logging.getLogger("uvicorn")


app = FastAPI()


@app.on_event("startup")
async def startup_event():
    log.info("Starting up...")
    init_db(app)


@app.on_event("shutdown")
async def shutdown_event():
    log.info("Shutting down...")


@app.post("/", response_model=SummaryResponseSchema, status_code=201)
async def create_summary(payload: SummaryPayloadSchema) -> SummaryResponseSchema:
    summary_id = await crud.post(payload)

    response_object = {
        "id": summary_id,
        "summary": payload.summary
    }
    return response_object


@app.get("/", response_model=List[SummarySchema])
async def read_all_todo() -> List[SummarySchema]:
    return await crud.get_all()


@app.put("/{id}/", response_model=SummarySchema)
async def update_todo(payload: SummaryPayloadSchema, id: int = Path(..., gt=0)) -> SummarySchema:
    todo = await crud.put(id, payload)
    if not todo:
        raise HTTPException(status_code=404,detail="Todos not found")
    return todo


@app.delete("/{id}/", response_model=SummaryResponseSchema)
async def delete_todo(id: int = Path(..., gt=0)) -> SummaryResponseSchema:
    todo = await crud.get(id)
    if not todo:
        raise HTTPException(status_code=404, detail="Todos not found")
    await crud.delete(id)
    return todo

```

æ›´æ–°ã¨å‰Šé™¤ç”¨ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ ã—ãŸã®ã§ã“ã‚Œã§ä¸€æ—¦CRUDã®æ©Ÿèƒ½ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚
http://localhost:8004/docs























































